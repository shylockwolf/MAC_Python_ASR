语音转文字 计划





基于调研结果，我为你制定了详细的实施计划：

## 📋 实施计划

### 一、技术方案

**核心技术栈：**

- **GUI框架**：PyQt6（现代化、跨平台）
- **语音识别**：faster-whisper + base模型
- **多线程**：QThread Worker模式（避免界面冻结）
- **语言支持**：中文（faster-whisper base支持99种语言，包括中文）

**项目结构：**

```
audio-transcriber/
├── main.py              # 程序入口
├── gui.py               # GUI界面（简约设计）
├── transcriber.py       # 语音识别核心（多线程Worker）
├── requirements.txt     # 依赖管理
└── README.md           # 使用说明
```

### 二、功能模块设计

#### 1. GUI界面（gui.py）

**简约设计要素：**

- 单一窗口，垂直布局
- 仅保留核心功能，无多余装饰
- 清晰的视觉层次

**组件列表：**

```
窗口标题："音频转文字" (500x600)
├── 文件选择区域
│   ├── QPushButton "选择MP3文件"
│   └── QLabel (显示选中的文件路径)
├── 模型选择区域  
│   └── QComboBox (仅显示base模型)
├── 控制区域
│   ├── QPushButton "开始转录"
│   └── QPushButton "停止转录" (转录时启用)
├── 进度区域
│   └── QProgressBar
├── 结果显示区域
│   ├── QLabel "转录结果："
│   └── QTextEdit (只读，显示识别文本)
└── 保存区域
    └── QPushButton "保存结果"
```

#### 2. 语音识别核心（transcriber.py）

**核心类设计：**

```
class TranscriptionWorker(QThread):
    """多线程转录工作线程"""
    
    signals:
        - progress_updated(int)  # 进度更新 (0-100)
        - segment_ready(str)       # 单段文本就绪（实时显示）
        - transcription_complete(str)  # 转录完成，返回完整文本
        - error_occurred(str)     # 错误信号
    
    方法：
        - run()                  # 主运行方法
        - stop()                 # 停止转录
        - transcribe(audio_path) # 执行转录逻辑
        
    配置：
        - model: "base"
        - language: "zh" (中文)
        - device: "cpu"
        - compute_type: "int8" (降低内存占用)
```

**转录流程：**

```
1. 验证音频文件（检查是否为MP3）
2. 加载faster-whisper base模型（首次运行会自动下载）
3. 执行转录，逐段返回文本
4. 实时更新进度和UI
5. 合并所有段落返回完整文本
```

#### 3. 主程序（main.py）

**职责：**

- 初始化QApplication
- 创建主窗口
- 连接信号与槽
- 程序入口

### 三、依赖管理

**requirements.txt内容：**

```
PyQt6>=6.6.0
faster-whisper>=1.0.0
```

**依赖说明：**

- PyQt6：GUI框架
- faster-whisper：语音识别（会自动下载模型约140MB）
- torch（faster-whisper自动依赖）

### 四、技术实现细节

**1. 多线程处理：**

```
# Worker模式，避免阻塞UI
worker = TranscriptionWorker(audio_file)
worker.progress_updated.connect(progress_bar.setValue)
worker.segment_ready.connect(text_edit.append)
worker.transcription_complete.connect(on_complete)
worker.start()
```

**2. 文件选择：**

```
QFileDialog.getOpenFileName(
    parent=self,
    caption="选择MP3文件",
    filter="MP3 Files (*.mp3);;All Files (*)"
)
```

**3. 进度计算：**

- faster-whisper提供逐段返回
- 根据总音频时长和当前段落位置计算进度百分比

**4. 错误处理：**

- 文件格式验证
- 模型加载失败
- 音频文件损坏
- 用户中断操作

### 五、用户体验优化

**首运行优化：**

- 自动检测并下载模型
- 显示下载进度提示
- 缓存模型到本地（~/.cache/huggingface/）

**性能优化：**

- 使用int8量化（减少内存占用约50%）
- CPU运行模式（避免GPU依赖）
- 实时显示转录结果（无需等待全部完成）

**界面响应：**

- 转录时禁用开始按钮
- 启用停止按钮
- 进度条实时更新
- 文本框实时追加内容

### 六、文件保存功能

**保存对话框：**

```
QFileDialog.getSaveFileName(
    caption="保存转录结果",
    filter="Text Files (*.txt);;All Files (*)"
)
```

**保存内容：**

- 纯文本格式
- UTF-8编码
- 包含完整转录文本

### 七、预期性能指标

**base模型特性：**

- 模型大小：约140MB
- 识别速度：约0.5-1x实时速度（1分钟音频约需30-60秒）
- 内存占用：约500-800MB
- 准确度：中等偏上，适合日常使用

**硬件要求：**

- 最低：4GB RAM
- 推荐：8GB+ RAM
- CPU：双核及以上

### 八、实施步骤

1. ✅ 创建项目目录结构
2. ✅ 编写requirements.txt
3. ✅ 实现transcriber.py（核心Worker类）
4. ✅ 实现gui.py（简约GUI界面）
5. ✅ 实现main.py（程序入口）
6. ✅ 编写README.md（使用说明）
7. ✅ 测试完整流程

------