# 音频转文字工具

基于PyQt6和OpenAI Whisper的语音转文字GUI应用，支持说话人识别。

## 功能特性

- 支持MP3和M4A格式音频文件
- 多种模型选择（Small/Medium/Large-v3）
- Medium模型默认，准确度高
- **说话人识别**（区分不同说话人）
  - 说话人标记为 [说话人01]、[说话人02] 等
  - 基于音频特征自动聚类
  - 无需额外下载说话人模型
- 实时进度显示和预估时间
- 自动保存到音频文件同目录
- 支持中断和恢复
- 支持另存为其他位置
- 简洁易用的图形界面

## 安装依赖

```bash
pip install -r requirements.txt
```

首次运行会自动下载：
- Whisper模型（~769MB for Medium）
- 无需下载说话人模型（使用内置聚类算法）

## 使用方法

1. 运行程序：
   ```bash
   python main.py
   ```

2. 点击"选择音频文件"选择音频文件

3. 选择模型（默认Medium，准确度高）
   - Small (~470MB, 较快, 中等准确度)
   - Medium (~769MB, 较慢, 高准确度) - 推荐
   - Large-v3 (~1550MB, 慢, 最高准确度)

4. 选择是否识别说话人
   - 勾选"识别说话人"可区分不同说话人
   - 输出格式：`[说话人01] 文本内容`
   - 不勾选则不区分说话人，输出纯文本

5. 点击"开始转录"开始识别

6. 转录过程中
   - 进度条显示实时进度
   - 状态显示剩余时间预估
   - 可点击"停止转录"中断

7. 转录完成后
   - 自动在同目录下保存为同名的txt文件
   - 例如：`audio.mp3` → `audio.txt`
   - 可使用"另存为"按钮保存到其他位置

## 技术说明

- **语音识别**：使用OpenAI Whisper模型（支持Small/Medium/Large）
- **说话人识别**：基于音频特征的无监督聚类算法
  - 使用Agglomerative聚类
  - 特征：时长、能量、过零率
  - 自动确定说话人数量
- Medium模型默认，准确度高（~769MB）
- 支持中文语音识别
- 首次运行会自动下载模型到 `~/.cache/whisper/`
- CPU运行模式，无需GPU
- 无需下载额外的说话人分离模型

## 输出示例

### 启用说话人识别
```
[说话人01] 你好，请介绍一下这个产品
[说话人02] 这是我们最新推出的智能音箱
[说话人01] 它有什么特点呢？
[说话人02] 支持语音控制和智能家居联动
```

### 禁用说话人识别
```
你好，请介绍一下这个产品
这是我们最新推出的智能音箱
它有什么特点呢？
支持语音控制和智能家居联动
```

## 系统要求

- Python 3.8+
- 8GB RAM（推荐16GB+）
- macOS / Windows / Linux

## 注意事项

1. **说话人识别准确性**：
   - 在安静环境下效果最佳
   - 说话人声音差异越大，识别越准确
   - 背景噪音可能影响识别效果

2. **说话人编号**：
   - 基于聚类结果自动编号
   - 每次转录编号可能不同
   - 通常识别为2-4个说话人

3. **性能建议**：
   - Medium模型在准确度和速度间平衡最好
   - 长音频建议启用说话人识别
   - 音频质量高时识别效果更佳
